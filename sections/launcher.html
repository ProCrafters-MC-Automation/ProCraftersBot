<template class="section-template">
  <section id="launcher" class="wrapper style3">
    <h1 id="launcher-header">Bot Launchers</h1>
    <h3 id="launcher-header">ProCrafters Bot Launcher</h3>
    <input type="text" name="address" id="address-field" placeholder="Server Address" value="localhost">
    <input type="text" name="port" id="port-field" placeholder="Server Port" value="25565">
    <input type="text" name="password" id="password-field" placeholder="Bot Password" value="Password">
    <input type="text" name="boss" id="boss-field" placeholder="Boss" value="Boss">
    <input type="text" name="bots" id="botNames-field" placeholder="Bots" value="Alpha Beta Omega Gamma Sigma Delta Theta">
    <button name="bots" onclick="bots()">Start Bots</button>
    <button name="stop" onclick="stop()">Force Stop</button>
    <p></p>
    <div id="buttonContainer"></div>
    <div id="webContainer"></div>
    <p id="botStarted"></p>
    <object data="src/UltimateBot/ultimateDebug.txt" style="min-height:100vh;width:100%"></object>

    <h2 id="launcher-header">Printer Bots</h2>
    <h3 id="launcher-header">Printer Bot(By Commands) Launcher</h3>
    <input type="text" name="address" id="command-address-field" placeholder="Server Address">
    <input type="text" name="port" id="command-port-field" placeholder="Server Port">
    <input type="text" name="prefix" id="prefix-field" placeholder="Prefix">
    <input type="text" name="botCount" id="bot-count-field" placeholder="Bot Count">
    <input type="text" name="x" id="x-field" placeholder="x">
    <input type="text" name="y" id="y-field" placeholder="y">
    <input type="text" name="z" id="z-field" placeholder="z">
    <button name="commandBots" onclick="commandBots()">Start Command Printer Bots</button>
    <p id="commandPrinterStarted"></p>
    <object data="src/CommandsPrinter/commandsPrinterDebug.txt" style="min-height:100vh;width:100%"></object>

    <h3 id="launcher-header">Printer Bot(By Placing) Launcher</h3>
    <input type="text" name="address" id="placer-address-field" placeholder="Server Address">
    <input type="text" name="port" id="placer-port-field" placeholder="Server Port">
    <input type="text" name="name" id="name-field" placeholder="Name">
    <input type="text" name="bossName" id="boss-name-field" placeholder="Boss">
    <input type="text" name="x" id="x-field" placeholder="x">
    <input type="text" name="y" id="y-field" placeholder="y">
    <input type="text" name="z" id="z-field" placeholder="z">
    <button name="commandBots" onclick="placerBots()">Start Placer Printer Bots</button>
    <p id="commandPrinterStarted"></p>
    <object data="src/PlacerPrinter/placerPrinterDebug.txt" style="min-height:100vh;width:100%"></object>

    <script type="text/javascript">
      const { spawn, exec } = require('child_process');
      const fs = require('fs');
      const kill = require('./')
      const http = require('http')

      const server = http.createServer((req, res) => {
        res.writeHead(200, {
          'Content-Type': 'text/plain'
        })

        res.end('Hi!')
      })

      let child;
        function startServer() {
            child = exec('java -jar server.jar', {cwd: 'server'}, function (error, stdout, stderr) {
                let out = stdout;
                let err = stderr;
                let fatal = error;
            });
        }

      let botsProc;
      function bots() {
        document.getElementById("botStarted").innerHTML = "Bots have been started";
        console.log('Bot Log:')
        let address = document.getElementById('address-field').value
        let port = document.getElementById('port-field').value
        let password = document.getElementById('password-field').value
        let boss = document.getElementById('boss-field').value
        let bots = document.getElementById('botNames-field').value
        botsProc = spawn('node', ['src/UltimateBot/index.js', address, port, password, boss, bots], {
          detached: false,
          shell: true,
        });

        let botNames = bots.split(" ");
        let websitePort = 9000;
        console.log(botNames)
        var firstPerson = document.createElement("iframe");
        var thirdPerson = document.createElement("iframe");
        var inventory = document.createElement("iframe");
        var radar = document.createElement("iframe")
        botNames.forEach(botName => {
          let button = document.createElement("button");
          var text = document.createTextNode(botName);
          button.addEventListener("click", ()=>{
            firstPerson.setAttribute("src", "http://localhost:" + websitePort);
            websitePort++
            webContainer.appendChild(firstPerson);
            thirdPerson.setAttribute("src", "http://localhost:" + websitePort);
            websitePort++
            webContainer.appendChild(thirdPerson);
            inventory.setAttribute("src", "http://localhost:" + websitePort);
            websitePort++
            webContainer.appendChild(inventory);
            radar.setAttribute("src", "http://localhost:" + websitePort);
            websitePort++
            webContainer.appendChild(radar);
          });
          button.appendChild(text);
          buttonContainer.appendChild(button);
        });

        botsProc.on('close', (code, signal) => {
          console.log('Bots were stopped')
          console.log('Exit Code:' + code)
          console.log('Signal:' + signal)
        })
      }

      function stop() {
        botsProc.stdin.pause();
        botsProc.kill();
        //process.kill(botsProc.pid)
        //process.kill(commandsProc.pid)
        //process.kill(placersProc.pid)
      }
      
      let commandsProc;
      function commandBots() {
        let commandAddress = document.getElementById('command-address-field').value
        let commandPort = document.getElementById('command-port-field').value
        let prefix = document.getElementById('prefix-field').value
        let botCount = document.getElementById('bot-count-field').value
        let x = document.getElementById('x-field').value
        let y = document.getElementById('y-field').value
        let z = document.getElementById('z-field').value
        
        commandsProc = spawn('node', ['src/CommandsPrinter/doByCommands.js', prefix, commandAddress, commandPort, botCount, x, y, z, 'src/image.jpg'], {
          detached: false,
          shell: true,
        });
      }

      let placersProc;
      function placerBots() {
        let placerAddress = document.getElementById('placer-address-field').value
        let placerPort = document.getElementById('placer-port-field').value
        let name = document.getElementById('name-field').value
        let boss = document.getElementById('boss-name-field')
        //let x = document.getElementById('x-field').value
        //let y = document.getElementById('y-field').value
        //let z = document.getElementById('z-field').value
        placersProc = spawn('node', ['src/PlacerPrinter/index.js', placerAddress, placerPort, name, boss, 'src/PlacerPrinter/image.jpg'], {
          detached: false,
          shell: true,
        });
      }

      
    </script>
  </section>
</template>