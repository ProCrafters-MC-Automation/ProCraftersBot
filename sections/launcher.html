<template class="section-template">
  <section id="launcher" class="wrapper style3">
    <h1 id="launcher-header">Bot Launchers</h1>
    <h3 id="launcher-header">ProCrafters Bot Launcher</h3>
    <input type="text" name="address" id="address-field" placeholder="Server Address">
    <input type="text" name="port" id="port-field" placeholder="Server Port">
    <input type="text" name="password" id="password-field" placeholder="Bot Password">
    <input type="text" name="boss" id="boss-field" placeholder="Boss">
    <input type="text" name="bots" id="botNames-field" placeholder="Bots">
    <button name="bots" onclick="bots()">Start Bots</button>
    <button name="stop" onclick="stop()">Force Stop</button>
    <div id="container"></div>
    <p id="botStarted"></p>
    <object data="src/UltimateBot/ultimateDebug.log" style="min-height:100vh;width:100%"></object>

    <h2 id="launcher-header">Printer Bots</h2>
    <h3 id="launcher-header">Printer Bot(By Commands) Launcher</h3>
    <input type="text" name="address" id="command-address-field" placeholder="Server Address">
    <input type="text" name="port" id="command-port-field" placeholder="Server Port">
    <input type="text" name="prefix" id="prefix-field" placeholder="Prefix">
    <input type="text" name="botCount" id="bot-count-field" placeholder="Bot Count">
    <input type="text" name="x" id="x-field" placeholder="x">
    <input type="text" name="y" id="y-field" placeholder="y">
    <input type="text" name="z" id="z-field" placeholder="z">
    <button name="commandBots" onclick="commandBots()">Start Command Printer Bots</button>
    <p id="commandPrinterStarted"></p>
    <object data="src/CommandsPrinter/commandsPrinterDebug.log" style="min-height:100vh;width:100%"></object>

    <h3 id="launcher-header">Printer Bot(By Placing) Launcher</h3>
    <input type="text" name="address" id="placer-address-field" placeholder="Server Address">
    <input type="text" name="port" id="placer-port-field" placeholder="Server Port">
    <input type="text" name="name" id="name-field" placeholder="Name">
    <input type="text" name="bossName" id="boss-name-field" placeholder="Boss">
    <input type="text" name="x" id="x-field" placeholder="x">
    <input type="text" name="y" id="y-field" placeholder="y">
    <input type="text" name="z" id="z-field" placeholder="z">
    <button name="commandBots" onclick="placerBots()">Start Placer Printer Bots</button>
    <p id="commandPrinterStarted"></p>
    <object data="src/PlacerPrinter/placerPrinterDebug.log" style="min-height:100vh;width:100%"></object>

    <script type="text/javascript">
      const { spawn, exec } = require('child_process');
      const fs = require('fs');

      let botsProc;
      function bots() {
        document.getElementById("botStarted").innerHTML = "Bots have been started";
        console.log('Bot Log:')
        let address = document.getElementById('address-field').value
        let port = document.getElementById('port-field').value
        let password = document.getElementById('password-field').value
        let boss = document.getElementById('boss-field').value
        let bots = document.getElementById('botNames-field').value
        botsProc = spawn('node', ['src/UltimateBot/index.js', address, port, password, boss, bots], {
          detached: true,
          stdio: "inherit",
          shell: true
        });

        let botNames = bots.split(" ");
        let websitePort = 9000;
        console.log(botNames)

        botNames.forEach(botName => {
          var button = document.createElement("button");
          button.id = botName;
          var text = document.createTextNode(botName);
          button.addEventListener("click", ()=>{
            website = 'http://localhost:' + websitePort;
            var firstPerson = window.open('http://localhost:' + websitePort, 'First Person view of ' + botName);
            var thirdPerson = window.open('http://localhost:' + websitePort + 1, 'Second Person view of ' + botName)
            var inventory = window.open('http://localhost:' + 2, 'Inventory of ' + botName)
          });
          button.appendChild(text);
          container.appendChild(button);
          let port = websitePort
        });

        botsProc.on('close', (code, signal) => {
          console.log('Bots were force stopped')
          console.log('In order to stop from within Minecraft: [BotName] leave')
        })
      }

      function commandBots() {
        let commandAddress = document.getElementById('command-address-field').value
        let commandPort = document.getElementById('command-port-field').value
        let prefix = document.getElementById('prefix-field').value
        let botCount = document.getElementById('bot-count-field').value
        let x = document.getElementById('x-field').value
        let y = document.getElementById('y-field').value
        let z = document.getElementById('z-field').value
        const command = 'node src/CommandsPrinter/doByCommands.js ' + prefix + ' ' + commandAddress + ' ' + commandPort + ' ' + botCount + ' ' + x + ' ' + y + ' ' + z + ' ' + 'src/image.jpg';
        console.log(command)
        exec(command, (error, stdout, stderr) => {
        if (error) {
            console.error(`error: ${error.message}`);
            return;
        }
        if (stderr) {
            console.error(`stderr: ${stderr}`);
            return;
        }
        console.log(`stdout:\n${stdout}`);
        });
      }

      function placerBots() {
        let placerAddress = document.getElementById('placer-address-field').value
        let placerPort = document.getElementById('placer-port-field').value
        let name = document.getElementById('name-field').value
        let boss = document.getElementById('boss-name-field')
        //let x = document.getElementById('x-field').value
        //let y = document.getElementById('y-field').value
        //let z = document.getElementById('z-field').value
        const command = 'node src/PlacerPrinter/index.js ' + placerAddress + ' ' + placerPort + ' ' + name + ' ' + boss + ' ' + 'src/PlacerPrinter/image.jpg';
        console.log(command)
        exec(command, (error, stdout, stderr) => {
        if (error) {
            console.error(`error: ${error.message}`);
            return;
        } if (stderr) {
            console.error(`stderr: ${stderr}`);
            return;
        } console.log(`stdout:\n${stdout}`);
        });
      }

      function stop() {
        botsProc.kill('SIGINT')
      }
    </script>
    <tab-group new-tab-button="false" sortable="true"></tab-group>

    <script src="node_modules/electron-tabs/dist/electron-tabs.js"></script>
  </section>
</template>